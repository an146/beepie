SRC_DIRS[] =
   gui
   layout
   mid
   tests
   util

vmount(-l, src, _build)
foreach (d, $(SRC_DIRS))
   mkdir -p _build/$(d)
   vmount(-l, src/$(d), _build/$(d))
   # WTF: vmount is scoped, but works without export
   # export

.SUBDIRS: _build

.PHONY: all
all: gui tester

.PHONY: test-gui
test-gui: gui
   ./_build/gui/gui

.PHONY: test
test: all
   ./_build/tests/tester

.DEFAULT: all test
#.DEFAULT: test-gui

.PHONY: clean
clean:
   rm -Rf _build
